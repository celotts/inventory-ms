"version: \"3.9\"\n\nservices:\n  discovery-service:\n    image: inventory/discovery-service\n    ports:\n      - \"${DISCOVERY_PORT}:${DISCOVERY_PORT}\"\n    environment:\n      - SPRING_PROFILES_ACTIVE=${SPRING_PROFILES_ACTIVE}\n      - JAVA_OPTS=${JAVA_OPTS}\n    healthcheck:\n      test: [\"CMD-SHELL\", \"curl -f ${DISCOVERY_SERVICE_HEALTH_URL} || exit 1\"]\n      interval: 10s\n      timeout: 5s\n      retries: 3\n    networks:\n      - inventory-network\n\n  config-service:\n    image: inventory/config-service\n    ports:\n      - \"${CONFIG_PORT}:${CONFIG_PORT}\"\n    environment:\n      - SPRING_PROFILES_ACTIVE=${SPRING_PROFILES_ACTIVE}\n      - DISCOVERY_SERVICE_HEALTH_URL=${DISCOVERY_SERVICE_HEALTH_URL}\n      - JAVA_OPTS=${JAVA_OPTS}\n      - SPRING_CLOUD_CONFIG_SERVER_GIT_URI=https://${GIT_USERNAME}:${GIT_TOKEN}@github.com/celotts/config-repo.git\n      - GIT_USERNAME=${GIT_USERNAME}\n      - GIT_TOKEN=${GIT_TOKEN}\n    depends_on:\n      discovery-service:\n        condition: service_healthy\n    healthcheck:\n      test: [\"CMD-SHELL\", \"curl -f ${CONFIG_SERVICE_HEALTH_URL} || exit 1\"]\n      interval: 30s\n      timeout: 10s\n      retries: 5\n    networks:\n      - inventory-network\n\n  product-db:\n    image: postgres:16\n    ports:\n      - \"5432:5432\"\n    environment:\n      - POSTGRES_DB=product\n      - POSTGRES_USER=product\n      - POSTGRES_PASSWORD=product123\n    volumes:\n      - product-data:/var/lib/postgresql/data\n    healthcheck:\n      test: [\"CMD-SHELL\", \"pg_isready -U product\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n    networks:\n      - inventory-network\n\nnetworks:\n  inventory-network:\n    driver: bridge\n\nvolumes:\n  product-data:"
